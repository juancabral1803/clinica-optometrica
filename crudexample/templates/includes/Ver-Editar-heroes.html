<!DOCTYPE html>
<html>
<head>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css" integrity="sha384-TX8t27EcRE3e/ihU7zmQxVncDAy5uIKz4rEkgIXeMed4M0jlfIDPvg6uqKI2xXr2" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ho+j7jyWK8fNQe+A12Hb8AhRq26LrZ/JpcUGGOn+Y7RsweNrtN/tE3MoK7ZeZDyx" crossorigin="anonymous"></script>
    <script> 
        function cargar(){
           var datosRecibidos = JSON.parse(localStorage.getItem("valoresFilaSeccionada"));
           var accion=localStorage.getItem("accion");
           $("#id").val(datosRecibidos.id);
           $("#nombre").val(datosRecibidos.name);
           $("#alias").val(datosRecibidos.alias);
           $("#edad").val(datosRecibidos.age);
           $("#email").val(datosRecibidos.email);     
           document.getElementById('accion').innerHTML = accion;     
        }

        function AgregarNuevo(){
        const csrf_token = getCookie('csrftoken');
        var data = {};
        data.name = document.getElementById("nombre").value;
        data.alias = document.getElementById("alias").value;
        data.age = document.getElementById("edad").value;
        data.email = document.getElementById("email").value;
        var datosRecibidos = JSON.parse(localStorage.getItem("valoresFilaSeccionada"));
        $.ajax({
        type: "POST",
        url: "/heroes/",
        data: data,
        beforeSend: function (xhr, settings) {
        xhr.setRequestHeader("X-CSRFToken", '{{ csrf_token }}');
        },
        success: function (arg) {
            alert("se agrego de forma correcta")
            location.href ="/zinggrid";
        }
        
        });
        }
 

        function Actualizar(){
        const csrf_token = getCookie('csrftoken');
        var data = {};
        data.name = document.getElementById("nombre").value;
        data.alias = document.getElementById("alias").value;
        data.age = document.getElementById("edad").value;
        data.email = document.getElementById("email").value;
        var datosRecibidos = JSON.parse(localStorage.getItem("valoresFilaSeccionada"));
        var Id=document.getElementById("id").value;
        var url="/heroes/"+Id;
        $.ajax({
        type: "patch",
        url: "/heroes/1/",
        data: data,
        beforeSend: function (xhr, settings) {
        xhr.setRequestHeader("X-CSRFToken", '{{ csrf_token }}');
        },
        success: function (arg) {
            alert("se actualizo de forma correcta")
            location.href ="/zinggrid";
        }
        
        });
        }

        function getCookie(name) {
        let cookieValue = null;
        if (document.cookie && document.cookie !== '') {
        const cookies = document.cookie.split(';');
        for (let i = 0; i < cookies.length; i++) {
            const cookie = cookies[i].trim();
            // Does this cookie string begin with the name we want?
            if (cookie.substring(0, name.length + 1) === (name + '=')) {
                cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
                break;
            }
        }
        }
        return cookieValue;
        }
        
    </script>
    <meta charset="utf-8">
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js"></script>
</head>
 
<body onload="cargar()">
    <span id="accion"></span>
    <form>
        <div class="form-row">
          <div class="form-group col-md-6">
            <label for="inputCity">Id</label>
            <input type="text" class="form-control" id="id">
          </div>
          <div class="form-group col-md-2">
            <label for="inputZip">Nombre</label>
            <input type="text" class="form-control" id="nombre">
          </div>
          <div class="form-group col-md-2">
            <label for="inputZip">Edad</label>
            <input type="text" class="form-control" id="edad">
          </div>
        </div>
        <div class="form-row">
            <div class="form-group col-md-2">
                <label for="inputZip">Alias</label>
                <input type="text" class="form-control" id="alias">
            </div>
            <div class="form-group col-md-2">
                <label for="inputZip">Email</label>
                <input type="text" class="form-control" id="email">
            </div>
        </div>
        <div>
            
        </div>

        <button type="submit" class="btn btn-primary">Guardar</button>
      </form>

     <button onclick="AgregarNuevo()">Agregar Nuevo</button>
     <button onclick="Actualizar()">Actualizar Registro</button>

     <a href="/zinggrid">Volver</a>


</body>
</html>